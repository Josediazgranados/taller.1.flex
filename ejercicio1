%{
#include "ejer1.tab.h"
#include <stdlib.h>
#include <stdio.h>
%}

%%
[0-9]+      { yylval = atoi(yytext); return NUMBER; }
"+"         { return ADD; }
"-"         { return SUB; }
"*"         { return MUL; }
"/"         { return DIV; }
"|"         { return ABS; }
"\n"        { return EOL; }
[ \t]       { }
"("         { return '('; }
")"         { return ')'; }
.           { printf("Token no reconocido: %s\n", yytext); }
%%
%{
#include <stdio.h>
#include <stdlib.h>

int yylex(void);
void yyerror(char *s);
%}

%token NUMBER ADD SUB MUL DIV ABS EOL

%left ADD SUB
%left MUL DIV
%right ABS

%%
calculo:
    | calculo linea
    ;

linea:
    expr EOL   { printf("Resultado: %d\n", $1); }
    ;

expr:
    NUMBER              { $$ = $1; }
  | expr ADD expr       { $$ = $1 + $3; }
  | expr SUB expr       { $$ = $1 - $3; }
  | expr MUL expr       { $$ = $1 * $3; }
  | expr DIV expr       {
                          if ($3 == 0) {
                              yyerror("División por cero");
                              YYABORT;
                          }
                          $$ = $1 / $3;
                        }
  | ABS expr            { $$ = $2 < 0 ? -$2 : $2; }
  | '(' expr ')'        { $$ = $2; }
  ;
%%

int main(int argc, char **argv) {
    printf("Introduce expresiones (Ctrl+D para salir):\n");
    yyparse();
    return 0;
}

void yyerror(char *s) {
    fprintf(stderr, "Error: %s\n", s);
}
¿Aceptará la calculadora una línea que contenga solo un comentario? ¿Por qué?
No, porque en el scanner (Flex) no hay ninguna regla para reconocer comentarios.
Si el usuario escribe algo como // comentario o # comentario, el scanner intentará leerlo como tokens válidos y,
al no encontrar coincidencia (excepto por el.), lo enviará como "Token no reconocido".
